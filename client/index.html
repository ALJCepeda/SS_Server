<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>Shazbot</title>

	<script src="/lib/jquery.js" type="text/javascript"></script>
	<script src="/lib/knockout.js" type="text/javascript"></script>
	<script src="/lib/underscore.js" type="text/javascript"></script>
	<script src="/socket.io/socket.io.js" type="text/javascript"></script>
</head>

<body id="bodyContainer">
	
</body>

<script>
var socket = io();
var irc = new IRC();
var inputBox = document.getElementById("inputBox");

socket.on("data", function(message) {
	irc.data(message);
});

socket.on("output", function(data) {
	irc.output(data.room, data.from, data.message);
});

socket.on("addRoom", function(data) {
	irc.addRoom(data.room);
});

socket.on("leaveRoom", function(data) {
	irc.leaveRoom(data.room);
});

function submitMessage() {
	var message = inputBox.value;
	
	if(message !== "") {
		var room = irc.selectedRoom();

		socket.emit("message", {
			room:room.name,
			message:message
		});

		inputBox.value = "";
	}
}

document.onkeyup = function() {
	if(window.event.keyCode === 13) {
		submitMessage();
	}
}

ko.applyBindings(irc, document.getElementById("bodyContainer"));
</script>
</html>