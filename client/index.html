<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>Shazbot</title>

	<script src="knockout/dist/knockout.js" type="text/javascript"></script>
	<script src="underscore/underscore.js" type="text/javascript"></script>
	<script src="/socket.io/socket.io.js" type="text/javascript"></script>
</head>

<style type="text/css">
	#inputBox {
		width:80%;
	}

	#fromDeviceContainer {
		width:100%;
		height:40%;
	}

	#toDeviceContainer {
		width:100%;
		height:40%;
	}
</style>

<body id="bodyContainer">
	<form>
		<input id="inputBox" type="text"></input>
		<input id="submit" type="button" value="Submit"></input>
	</form>

	<div id="fromDeviceContainer">
		<h2>From Device:</h2>
		<ul data-bind="foreach:fromDevice">
			<li><span data-bind="text: $data"></span></li>
		</ul>
	</div>

	<div id="toDeviceContainer">
		<h2>To Device:</h2>
		<ul data-bind="foreach:toDevice">
			<li><span data-bind="text: $data"></span></li>
		</ul>
	</div>
</body>

<script type="text/javascript">
	var fromDevice = ko.observableArray([]);
	var toDevice = ko.observableArray([]);
	var inputBox = document.getElementById("inputBox");
	var socket = io();

	function submitMessage() {
		var message = inputBox.value;
		
		if(message !== "") {
			socket.emit("data", {
				message:message
			});

			inputBox.value = "";
		}
	}

	document.getElementById("submit").onclick = function() {
		submitMessage();
	};

	document.onkeyup = function() {
		if(window.event.keyCode === 13 && document.activeElement === inputBox) {
			submitMessage();
		}
	};

	ko.applyBindings({
		fromDevice:fromDevice,
		toDevice:toDevice
	}, document.getElementById("bodyContainer"));

	socket.on("data", function(data) {
		fromDevice.push(data.message);
	});

	socket.emit("startBrowser", { id:"test" });
</script>

</html>